!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.p=t()}}(function(){return function t(e,n,r){function i(s,c){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!c&&a)return a(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return i(n?n:t)},h,h.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){var r=t("./model"),i=r.extend({_filters:null,_sort:null,_hiddenSelected:null,selected:null,length:{get:function(){return this._current.length}},$create:function(t){this._source=t,this._current=[],this._filters=[],this._sort=[],this._source.on("changed",this._invalidate,this),this.refresh=this.refresh.bind(this),this._invalidate({added:this._source.toArray()})},refresh:function(){this._invalidate()},addFilter:function(t){this._filters.push(t),this._invalidate()},removeFilter:function(t){var e=this._filters.indexOf(t);-1!==e&&(this._filters.splice(e,1),this._invalidate())},addSort:function(t){this._sort.push(t),this._invalidate()},removeSort:function(t){var e=this._sort.indexOf(t);-1!==e&&(this._sort.splice(e,1),this._invalidate())},get:function(t){return this._current[t]},toArray:function(){return this._current},forEach:function(){return this._current.forEach.apply(this._current,arguments)},_resubscribe:function(t,e){e.removed.forEach(function(e){t.properties&&t.properties.forEach(function(t){e.off(t+"_changed",this.refresh,this)},this)},this),e.added.forEach(function(e){t.properties&&t.properties.forEach(function(t){e.on(t+"_changed",this.refresh,this)},this)},this)},_invalidate:function(t){t||(t={added:this._source.toArray(),removed:this._source.toArray()}),this._current=this._source.toArray().concat(),this._filters.forEach(function(e){this._resubscribe(e,t),this._current=this._current.filter(function(t){return e.fn(t)})},this),this._sort.length&&(this._sort.forEach(function(e){this._resubscribe(e,t)},this),this._current.sort(function(t,e){for(var n=this._sort.concat(),r=0,i=n.shift();0===r&&i;)r=i.fn(t,e),i=n.shift();return r}.bind(this))),this.selected&&-1===this._current.indexOf(this.selected)?(this._hiddenSelected=this.selected,this.selected=null):!this.selected&&this._hiddenSelected&&-1!==this._current.indexOf(this._hiddenSelected)&&(this.selected=this._hiddenSelected,this._hiddenSelected=null),this.dispatch("changed")}});e.exports=i},{"./model":7}],2:[function(t,e,n){var r=t("./model"),i=r.extend({$create:function(t){this.array=t||[]},length:{get:function(){return this.array.length}},indexOf:function(){return this.array.indexOf.apply(this.array,arguments)},add:function(t){var e=this.array.push(t);return this.dispatch("changed",{added:[t],removed:[]}),e},remove:function(t){var e=this.array.indexOf(t);-1!==e&&(this.array.splice(e,1),this.dispatch("changed",{added:[],removed:[t]}))},forEach:function(t,e){return this.array.forEach(t,e)},concat:function(){return i.create(this.array.concat.apply(this.array,arguments))},filter:function(t,e){return i.create(this.array.filter(t,e))},toArray:function(){return this.array},toJSON:function(){return this.toArray()}});e.exports=i},{"./model":7}],3:[function(t,e,n){var r=t("./di"),i=t("./collection"),o=t("./object"),s=t("./utils"),c=o.extend({$meta:{domProcessors:[s.domProcessors.createComponents,s.domProcessors.injectElement]},tag:"",html:"",root:{get:function(){return this._root},set:function(t){this._root=t,this.processRoot()}},parent:null,children:{get:function(){return this._children}},$create:function(){var t;if(this._children=[],this.tag||this.html||(this.tag="div"),this.tag&&!this.html&&(this.html="<"+this.tag+"></"+this.tag+">"),t=s.html.parseHTML(this.html),t.childNodes.length>1)throw new Error("Component should have only one root element");this.root=t.firstChild,this.processInstance()},processRoot:function(){var t,e,n,r;this._root&&(this.$meta.domProcessors||[]).forEach(function(i){for(e=this._root.querySelectorAll("["+i.attribute+"]"),t=0;t<e.length;t++)n=e[t],r=n.getAttribute(i.attribute),i.process(this,n,r)},this)},processInstance:function(){s.meta(this,"renderWith",function(t){this[t]=i.create(this[t]||[])}.bind(this))},processBinding:{injectInit:!0,value:function(){var t;s.meta(this,"bindWith",function(e,n){t=s.isPrimitive(n)?[n]:n,t.forEach(function(t){s.bind(this,t,this[e])},this)}.bind(this)),s.meta(this,"renderWith",function(t,e){s.renderList(this,t,e)}.bind(this))}},__fastinject__:{get:function(){return this.___fastinject___},set:function(t){this.___fastinject___||(this.___fastinject___=t,this._children.forEach(this.__fastinject__,this),this.$meta.presenter&&(this.__presenter__=this.$meta.presenter.create()))}},__presenter__:{get:function(){return this.___presenter___},set:function(t){this.___presenter___=t,t.view=this,this.___fastinject___(t)}},init:{injectInit:!0,value:function(){}},destroy:{injectDestroy:!1,value:function(){this.__presenter__&&this.__presenter__.destroy&&this.__presenter__.destroy(),this._children.concat().forEach(function(t){this.remove(t)},this)}},add:function(t){if(!t)throw new Error("Child component cannot be null");if(!t.root)throw new Error("Child component should have root property");t.parent&&t.parent.remove(t),t.parent=this,this._children.push(t),this.root.appendChild(t.root),this.__fastinject__&&this.__fastinject__(t)},remove:function(t){var e=this._children.indexOf(t);-1!==e&&(this._children.splice(e,1),t.root.parentNode.removeChild(t.root),t.destroy())},attach:function(t,e,n){this._children.push(t),(n||this.root).insertBefore(t.root,e),(n||this.root).removeChild(e)},attachTo:function(t,e){var n=c.Root(t,e);n.add(this)}});c.Root=function(t,e){var n=c.create();return e=e||r.create(),n.root=t,e.register(n),n},c.Mount=function(t,e,n){var i,o,s;i=document.getElementsByTagName(t),n||(n=r.create(),n.build());for(var c=0;c<i.length;c++)o=i[c],s=e.create(),o.parentNode.insertBefore(s.root,o),o.parentNode.removeChild(o),n.register(s),n.process(s);return s},e.exports=c},{"./collection":2,"./di":5,"./object":8,"./utils":10}],4:[function(t,e,n){var r={autobind:function(){for(var t in this)"function"==typeof this[t]&&(this[t]=this[t].bind(this))}};e.exports=r},{}],5:[function(t,e,n){var r=t("./protoplast"),i=t("./dispatcher"),o=r.extend({$create:function(){var t=this;this._objects={pub:function(e,n){t._dispatcher.dispatch(e,n)},sub:function(e){var n=this;return{add:function(r){t._dispatcher.on(e,r,n)},remove:function(r){t._dispatcher.off(e,r,n)}}}},this._unknows=[],this._dispatcher=i.create()},_objects:null,_unknows:null,register:function(t,e){1==arguments.length?(e=t,this._unknows.push(e)):this._objects[t]=e,e.__fastinject__=function(t){t.__fastinject__=e.__fastinject__.bind(this),this.process(t)}.bind(this)},_injectDependencies:function(t){var e;t.$meta&&t.$meta.properties&&t.$meta.properties.inject&&Object.keys(t.$meta.properties.inject).forEach(function(n){e=t.$meta.properties.inject[n],this._objects[e]?t[n]=this._objects[e]:e.isPrototypeOf&&this._unknows.forEach(function(r){e.isPrototypeOf(r)&&(t[n]=r)},this)},this)},_runOnAll:function(t){Object.keys(this._objects).forEach(function(e){var n=this._objects[e];t(n)},this),this._unknows.forEach(function(e){t(e)},this)},_runInitMethods:function(t){t.$meta&&t.$meta.properties&&t.$meta.properties.injectInit&&Object.keys(t.$meta.properties.injectInit).forEach(function(e){t[e]()},this)},_runDestroyMethods:function(t){t.$meta&&t.$meta.properties&&t.$meta.properties.injectDestroy&&Object.keys(t.$meta.properties.injectDestroy).forEach(function(e){t[e]()},this)},_initialiseSubscriptions:function(t){t.$meta&&t.$meta.properties&&t.$meta.properties.sub&&Object.keys(t.$meta.properties.sub).forEach(function(e){this._objects.sub.call(t,t.$meta.properties.sub[e]).add(t[e])},this)},process:function(t){this._injectDependencies(t),this._runInitMethods(t),this._initialiseSubscriptions(t)},build:function(){this._runOnAll(this.process.bind(this))},destroy:function(){this._runOnAll(this._runDestroyMethods.bind(this))}});e.exports=o},{"./dispatcher":6,"./protoplast":9}],6:[function(t,e,n){var r=t("./protoplast"),i=r.extend({$create:function(){this._topics={}},dispatch:function(t){var e=Array.prototype.slice.call(arguments,1);(this._topics[t]||[]).forEach(function(t){t.handler.apply(t.context,e)})},on:function(t,e,n){if(!e)throw new Error("Handler is required for event "+t);this._topics[t]=this._topics[t]||[],this._topics[t].push({handler:e,context:n})},off:function(t,e,n){if(t)this._topics[t]=(this._topics[t]||[]).filter(function(t){return e?t.handler!==e:t.context!==n});else for(t in this._topics)this._topics.hasOwnProperty(t)&&this.off(t,e,n)}});e.exports=i},{"./protoplast":9}],7:[function(t,e,n){function r(t,e,n){var r=e.value;delete e.value,delete e.writable,delete e.enumerable,e.get=function(){return void 0===this["_"+t]&&(this["_"+t]=r.call(this)),this["_"+t]},n?e.set=function(){var e=this["_"+t];this["_"+t]=void 0,this.dispatch(t+"_changed",void 0,e)}:e.set=function(){var e,n;n=this["_"+t],this["_"+t]=void 0,e=this[t],e!==n&&this.dispatch(t+"_changed",e,n)}}function i(t,e,n){var r=e.value;delete e.value,delete e.writable,delete e.enumerable,e.get=function(){return this["_"+t]},e.set=function(e){if(e!==this["_"+t]){var n=this["_"+t];this["_"+t]=e,this.dispatch(t+"_changed",e,n)}},n["_"+t]=r}var o=t("./protoplast"),s=t("./dispatcher"),c=t("./utils"),a=o.extend([s],{$create:function(){var t=this.$meta.properties.computed;for(var e in t)t.hasOwnProperty(e)&&t[e].forEach(function(t){(function(e){c.bind(this,t,function(){this[e]=void 0}.bind(this))}).bind(this)(e)},this)},$defineProperty:function(t,e){if(this.$meta.properties.computed&&this.$meta.properties.computed[t]){var n=this.$meta.properties.lazy&&this.$meta.properties.lazy[t];r(t,e,n)}else e.get&&-1===["number","boolean","string"].indexOf(typeof e.value)||i(t,e,this);o.$defineProperty.call(this,t,e)}});e.exports=a},{"./dispatcher":6,"./protoplast":9,"./utils":10}],8:[function(t,e,n){var r=t("./constructors"),i=t("./utils"),o=t("./model"),s=o.extend({$meta:{constructors:[r.autobind]},init:{injectInit:!0,value:function(){}},destroy:{injectDestroy:!0,value:function(){}},bind:function(t,e){i.bind(this,t,e)},bindProperty:function(t,e,n){i.bindProperty(this,t,e,n)}});e.exports=s},{"./constructors":4,"./model":7,"./utils":10}],9:[function(t,e,n){(function(n){var r=t("./utils"),i=new function(){};i.$meta={},i.$defineProperty=function(t,e){Object.defineProperty(this,t,e)},i.create=function(){return r.createObject(this,arguments)},i.extend=function(t,e){var n,i,o,s=Object.create(this);t instanceof Array||(e=t,t=[]),e=e||{},t=t||[],n=e.$meta||{},n.properties=n.properties||{},delete e.$meta,void 0!==e.$create&&(n.constructors=n.constructors||[],n.constructors.push(e.$create),delete e.$create),s=r.mixin(s,t);var c=[];for(var a in e){if("[object Object]"!==Object.prototype.toString.call(e[a]))o={value:e[a],writable:!0,enumerable:!0,configurable:!0};else{o=e[a],a in this||o.set||o.get||o.value||(o.value=void 0);for(var u in o)o.hasOwnProperty(u)&&-1===["value","get","set","writable","enumerable","configurable"].indexOf(u)&&(n.properties[u]=n.properties[u]||{},n.properties[u][a]=o[u],delete o[u]);o.hasOwnProperty("writable")||o.hasOwnProperty("set")||o.hasOwnProperty("get")||(o.writable=!0),o.hasOwnProperty("enumerable")||(o.enumerable=!0),o.hasOwnProperty("configurable")||(o.configurable=!0)}c.push({property:a,desc:o})}return i=(t||[]).reduce(function(t,e){return r.merge(t,e.$meta)},{}),n=r.merge(n,i),s.$meta=r.merge(n,this.$meta),c.forEach(function(t){var e=t.property,n=t.desc;s.$defineProperty(e,n)}),s},n.Protoplast=i,e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./utils":10}],10:[function(t,e,n){var r=t("./utils/common"),i=t("./utils/binding"),o=t("./utils/component"),s=t("./utils/html");e.exports={createObject:r.createObject,merge:r.merge,isLiteral:r.isLiteral,isPrimitive:r.isPrimitive,mixin:r.mixin,uniqueId:r.uniqueId,meta:r.meta,resolveProperty:i.resolveProperty,bind:i.bind,bindSetter:i.bindSetter,bindProperty:i.bindProperty,bindCollection:i.bindCollection,renderList:o.renderList,createRendererFunction:o.createRendererFunction,renderListDefaults:o.renderListDefaults,domProcessors:{injectElement:o.domProcessors.injectElement,createComponents:o.domProcessors.createComponents},html:s}},{"./utils/binding":11,"./utils/common":12,"./utils/component":13,"./utils/html":14}],11:[function(t,e,n){var r=function(t,e,n){var i=e.split(".");if(e)if(1===i.length)n(t[e]);else{var o=t[i[0]],s=i.slice(1).join(".");o&&r(o,s,n)}else n(t)},i=function(t,e,n,o){var s,c=e.split(".");if(o=o||{},1===c.length)t.on(e+"_changed",n,o),s=t[e],void 0!==s&&n(t[e]);else{var a=t[c[0]],u=c.slice(1).join(".");a&&i(a,u,function(){r(a,u,n)},o),t.on(c[0]+"_changed",function(e,r){r&&r.on&&r.off(c[0]+"_changed",n),i(t[c[0]],u,n,o)},o)}return{start:function(){i(t,e,n)},stop:function(){for(r(t,e,function(t){t.off&&t.off(null,null,o)});c.length;)c.pop(),r(t,c.join("."),function(t){t.off(null,null,o)})}}},o=function(t,e,n,o){var s,c=null;return o=o||{},i(t,e,function(){r(t,e,function(e){c&&(c.off&&c.off("changed",s),c=null,s=null),e&&(c=e,s=n.bind(t,e),e.on&&e.on("changed",s,o)),n(e)})},o)},s=function(t,e,n){var r;if(3===arguments.length)return o(t,e,n);var i,c=[];for(var a in e)e.hasOwnProperty(a)&&(r=e[a],r instanceof Array||(r=[r]),r.forEach(function(e){i=s(t,a,e.bind(t)),c.push(i)}));var u=arguments;return{start:function(){s.apply(null,u)},stop:function(){c.forEach(function(t){t.stop()})}}},c=function(t,e,n,i){var o=i.split("."),c=o.pop();return s(t,e,function(){r(t,e,function(t){r(n,o.join("."),function(e){e&&(e[c]=t)})})})};e.exports={resolveProperty:r,bind:s,bindSetter:i,bindProperty:c,bindCollection:o}},{}],12:[function(t,e,n){function r(t){var e=++f;return(t||"")+e}function i(t,e){var n=Object.create(t);return n.$meta.constructors&&n.$meta.constructors.forEach(function(t){t.apply(n,e)}),n}function o(t){return-1!==["number","boolean","string","function"].indexOf(typeof t)}function s(t){return t&&t.constructor===Object}function c(t,e){for(var n in e)e.hasOwnProperty(n)&&(e[n]instanceof Array?t[n]=e[n].concat(t[n]||[]):o(e[n])||!s(e[n])?t.hasOwnProperty(n)||(t[n]=e[n]):(t[n]=t[n]||{},c(t[n],e[n])));return t}function a(t,e){for(var n in e)"__"===n.substr(0,2)||n in t||(t[n]=e[n]);return t}function u(t,e){return e.forEach(function(e){a(t,e)}),t}function h(t,e,n){for(var r in t.$meta.properties[e])t.$meta.properties[e].hasOwnProperty(r)&&n(r,t.$meta.properties[e][r])}var f=0;e.exports={createObject:i,merge:c,isLiteral:s,isPrimitive:o,mixin:u,uniqueId:r,meta:h}},{}],13:[function(t,e,n){var r=t("./binding"),i={attribute:"data-prop",process:function(t,e,n){!function(e){t[n]=e,t.$meta.elementWrapper&&(t[n]=t.$meta.elementWrapper(t[n]))}(e)}},o={attribute:"data-comp",process:function(t,e,n){var r=t[n]=t.$meta.properties.component[n].create();t.attach(r,e,e.parentNode)}},s={remove:function(t,e){t.remove(e)},create:function(t,e,n,r){var i=n.create();i[r]=e,t.add(i)},update:function(t,e,n){t[n]=e}},c=function(t,e){if(e=e||{},e.create=e.create||s.create,e.remove=e.remove||s.remove,e.update=e.update||s.update,e.property=e.property||"data",!e.renderer)throw new Error("Renderer is required");return function(t){for(var n=Math.max(this.children.length,t.length),r=this.children.concat(),i=0;n>i;i++)r[i]&&t.toArray()[i]?e.update(r[i],t.toArray()[i],e.property):r[i]?t.toArray()[i]||e.remove(this,r[i]):e.create(this,t.toArray()[i],e.renderer,e.property)}.bind(t)},a=function(t,e,n){var i=c(n.parent||t,n);r.bindCollection(t,e,i)};e.exports={createRendererFunction:c,renderList:a,renderListDefaults:s,domProcessors:{injectElement:i,createComponents:o}}},{"./binding":11}],14:[function(t,e,n){var r=function(){var t=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,e=/<([\w:]+)/,n=/<|&#?\w+;/,r={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],tbody:[1,"<table>","</table>"],_default:[0,"",""]};return function(i,o){o=o||document;var s,c,a,u,h=o.createDocumentFragment();if(n.test(i)){for(s=h.appendChild(o.createElement("div")),c=(e.exec(i)||["",""])[1].toLowerCase(),a=r[c]||r._default,s.innerHTML=a[1]+i.replace(t,"<$1></$2>")+a[2],u=a[0];u--;)s=s.lastChild;for(h.removeChild(h.firstChild);s.firstChild;)h.appendChild(s.firstChild)}else h.appendChild(o.createTextNode(i));return h}}();e.exports={parseHTML:r}},{}],15:[function(t,e,n){(function(n){var r=t("./js/protoplast"),i=t("./js/collection"),o=t("./js/collection-view"),s=t("./js/dispatcher"),c=t("./js/di"),a=t("./js/component"),u=t("./js/model"),h=t("./js/object"),f=t("./js/utils"),l=t("./js/constructors"),d={extend:r.extend.bind(r),create:r.create.bind(r),Dispatcher:s,Context:c,Component:a,Model:u,Object:h,Collection:i,CollectionView:o,constructors:l,utils:f};n.Protoplast=d,e.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./js/collection":2,"./js/collection-view":1,"./js/component":3,"./js/constructors":4,"./js/di":5,"./js/dispatcher":6,"./js/model":7,"./js/object":8,"./js/protoplast":9,"./js/utils":10}]},{},[15])(15)});