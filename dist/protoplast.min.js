!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.p=t()}}(function(){return function t(e,r,n){function i(s,c){if(!r[s]){if(!e[s]){var a="function"==typeof require&&require;if(!c&&a)return a(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var u=r[s]={exports:{}};e[s][0].call(u.exports,function(t){var r=e[s][1][t];return i(r?r:t)},u,u.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){var n=t("./model"),i=n.extend({_filters:null,_sort:null,_hidden_selected:null,selected:null,length:{get:function(){return this._current.length}},$create:function(t){this._source=t,this._current=[],this._filters=[],this._sort=[],this._source.on("changed",this._invalidate,this),this.refresh=this.refresh.bind(this),this._invalidate({added:this._source.toArray()})},refresh:function(){this._invalidate()},add_filter:function(t){this._filters.push(t),this._invalidate()},remove_filter:function(t){var e=this._filters.indexOf(t);-1!==e&&(this._filters.splice(e,1),this._invalidate())},add_sort:function(t){this._sort.push(t),this._invalidate()},remove_sort:function(t){var e=this._sort.indexOf(t);-1!==e&&this._sort.splice(e,1)},get:function(t){return this._current[t]},toArray:function(){return this._current},concat:function(){return this._current.concat.apply(this._current,arguments)},forEach:function(){return this._current.forEach.apply(this._current,arguments)},_resubscribe:function(t,e){e.removed.forEach(function(e){t.properties&&t.properties.forEach(function(t){e.off(t+"_changed",this.refresh,this)},this)},this),e.added.forEach(function(e){t.properties&&t.properties.forEach(function(t){e.on(t+"_changed",this.refresh,this)},this)},this)},_invalidate:function(t){t||(t={added:this._source.toArray(),removed:this._source.toArray()}),this._current=this._source.toArray().concat(),this._filters.forEach(function(e){this._resubscribe(e,t),this._current=this._current.filter(function(t){return e.fn(t)})},this),this._sort.length&&(this._sort.forEach(function(e){this._resubscribe(e,t)},this),this._current.sort(function(t,e){for(var r=this._sort.concat(),n=0,i=r.shift();0===n&&i;)n=i.fn(t,e),i=r.shift();return n}.bind(this))),this.selected&&-1===this._current.indexOf(this.selected)?(this._hidden_selected=this.selected,this.selected=null):!this.selected&&this._hidden_selected&&-1!==this._current.indexOf(this._hidden_selected)&&(this.selected=this._hidden_selected,this._hidden_selected=null),this.dispatch("changed")}});e.exports=i},{"./model":7}],2:[function(t,e,r){var n=t("./model"),i=n.extend({$create:function(t){this.array=t||[]},length:{get:function(){return this.array.length}},indexOf:function(){return this.array.indexOf.apply(this.array,arguments)},add:function(t){var e=this.array.push(t);return this.dispatch("changed",{added:[t],removed:[]}),e},remove:function(t){var e=this.array.indexOf(t);-1!==e&&(this.array.splice(e,1),this.dispatch("changed",{added:[],removed:[t]}))},forEach:function(t,e){return this.array.forEach(t,e)},concat:function(){return i.create(this.array.concat.apply(this.array,arguments))},filter:function(t,e){return i.create(this.array.filter(t,e))},toArray:function(){return this.array},toJSON:function(){return this.toArray()}});e.exports=i},{"./model":7}],3:[function(t,e,r){var n=t("./model"),i=t("./utils"),o=n.extend({$meta:{dom_processors:[i.dom_processors.create_component,i.dom_processors.inject_element]},tag:"",html:"",root:{get:function(){return this._root},set:function(t){this._root=t,this.process_root()}},children:{get:function(){return this._children}},$create:function(){this._children=[],this.tag||this.html||(this.tag="div"),this.tag&&!this.html&&(this.html="<"+this.tag+"></"+this.tag+">");var t=document.createElement("div");t.innerHTML=this.html,this.root=t.firstChild},process_root:function(){var t,e,r,n;this._root&&(this.$meta.dom_processors||[]).forEach(function(i){for(e=this._root.querySelectorAll("["+i.attribute+"]"),t=0;t<e.length;t++)r=e[t],n=r.getAttribute(i.attribute),i.process(this,r,n)},this)},__fastinject__:{get:function(){return this.___fastinject___},set:function(t){this.___fastinject___||(this.___fastinject___=t,this._children.forEach(this.__fastinject__,this),this.$meta.presenter&&(this.__presenter__=this.$meta.presenter.create()))}},__presenter__:{get:function(){return this.___presenter___},set:function(t){this.___presenter___=t,t.view=this,this.___fastinject___(t)}},init:{inject_init:!0,value:function(){}},destroy:function(){this.__presenter__&&this.__presenter__.destroy&&this.__presenter__.destroy(),this._children.concat().forEach(function(t){this.remove(t)},this)},add:function(t){if(!t)throw new Error("Child component cannot be null");if(!t.root)throw new Error("Child component should have root property");this._children.push(t),this.__fastinject__&&this.__fastinject__(t),this.root.appendChild(t.root)},remove:function(t){var e=this._children.indexOf(t);-1!==e&&(this._children.splice(e,1),this.root.removeChild(t.root),t.destroy())},attach:function(t,e){this._children.push(t),this.root.insertBefore(t.root,e),this.root.removeChild(e)}});o.Root=function(t,e){var r=o.create();return r.root=t,e&&e.register(r),r},e.exports=o},{"./model":7,"./utils":9}],4:[function(t,e,r){var n=t("./utils"),i={uniqueId:function(){this.$id=n.uniqueId(this.$meta.$prefix)},autobind:function(){for(var t in this)"function"==typeof this[t]&&(this[t]=this[t].bind(this))}};e.exports=i},{"./utils":9}],5:[function(t,e,r){var n=t("./protoplast"),i=t("./dispatcher"),o=n.extend({$create:function(){var t=this;this._objects={pub:function(e,r){t._dispatcher.dispatch(e,r)},sub:function(e){var r=this;return{add:function(n){t._dispatcher.on(e,n,r)},remove:function(n){t._dispatcher.off(e,n,r)}}}},this._unknows=[],this._dispatcher=i.create()},_objects:null,_unknows:null,register:function(t,e){1==arguments.length?(e=t,this._unknows.push(e)):this._objects[t]=e,e.__fastinject__=function(t){this.register(t),this.process(t)}.bind(this),e.$meta&&e.$meta.properties&&e.$meta.properties.inject&&this.define_injected_properties(e,e.$meta.properties.inject)},process:function(t){t.$meta&&t.$meta.properties&&t.$meta.properties.inject_init&&Object.keys(t.$meta.properties.inject_init).forEach(function(e){t[e]()},this),t.$meta&&t.$meta.properties&&t.$meta.properties.sub&&Object.keys(t.$meta.properties.sub).forEach(function(e){this._objects.sub.call(t,t.$meta.properties.sub[e]).add(t[e])},this)},define_injected_properties:function(t,e){var r,n=this;for(var i in e)e.hasOwnProperty(i)&&(r=e[i],function(e){Object.defineProperty(t,i,{get:function(){return n._objects[e]}})}(r))},build:function(){Object.keys(this._objects).forEach(function(t){var e=this._objects[t];this.process(e)},this),this._unknows.forEach(function(t){this.process(t)},this)}});e.exports=o},{"./dispatcher":6,"./protoplast":8}],6:[function(t,e,r){var n=t("./protoplast"),i=n.extend({$create:function(){this._topics={}},dispatch:function(t){var e=Array.prototype.slice.call(arguments,1);(this._topics[t]||[]).forEach(function(t){t.handler.apply(t.context,e)})},on:function(t,e,r){if(!e)throw new Error("Handler is required for event "+t);this._topics[t]=this._topics[t]||[],this._topics[t].push({handler:e,context:r})},off:function(t,e,r){this._topics[t]=(this._topics[t]||[]).filter(function(t){return e?t.handler!==e:t.context!==r})}});e.exports=i},{"./protoplast":8}],7:[function(t,e,r){function n(t,e){var r=e.value;delete e.value,delete e.writable,delete e.enumerable,e.get=function(){return void 0===this["_"+t]&&(this["_"+t]=r.call(this)),this["_"+t]},e.set=function(){var e=this["_"+t];this["_"+t]=void 0,this.dispatch(t+"_changed",void 0,e)}}function i(t,e,r){var n=e.value;delete e.value,delete e.writable,delete e.enumerable,e.get=function(){return this["_"+t]},e.set=function(e){if(e!==this["_"+t]){var r=this["_"+t];this["_"+t]=e,this.dispatch(t+"_changed",e,r)}},r["_"+t]=n}var o=t("./protoplast"),s=t("./dispatcher"),c=t("./utils"),a={def:function(t,e,r){r.$meta.properties.computed&&r.$meta.properties.computed[t]?n(t,e):e.get||e.value&&-1===["number","boolean","string"].indexOf(typeof e.value)||i(t,e,r)}},h=o.extend([s],{$meta:{hooks:[a]},invalidate_injected_bindings:{inject_init:!0,value:function(){for(var t in this.$meta.properties.inject)this.dispatch(t+"_changed")}},$create:function(){for(var t in this.$meta.properties.computed)this.$meta.properties.computed[t].forEach(function(e){(function(){c.bind(this,e,function(){this[t]=void 0}.bind(this))}).bind(this)(t)},this)}});e.exports=h},{"./dispatcher":6,"./protoplast":8,"./utils":9}],8:[function(t,e,r){(function(r){var n=t("./utils"),i={$meta:{},create:function(){return n.createObject(this,arguments)}};i.extend=function(t,e){var r,i,o,s,c=Object.create(this),a=[];t instanceof Array||(e=t,t=[]),e=e||{},t=t||[],e.$meta&&e.$meta.hooks&&e.$meta.hooks.forEach(function(t){t.desc&&t.desc(e)}),r=e.$meta||{},r.properties=r.properties||{},delete e.$meta,void 0!==e.$create&&(r.constructors=r.constructors||[],r.constructors.push(e.$create),delete e.$create),c=n.mixin(c,t);var h=[];for(var u in e){if(s=!1,e[u]&&e[u].hooks&&!function(t,n){e[t].hooks.forEach(function(e){e.desc&&e.desc(c,t,n),e.proto&&!function(e){a.push(function(r){r[t]=e(r[t],t,r)})}(e.proto),e.instance&&(r.constructors=r.constructors||[],r.constructors.push(function(){this[t]=e.instance(this[t],t,c,this)}))})}(u,e[u]),"[object Object]"!==Object.prototype.toString.call(e[u]))s=!0,o={value:e[u],writable:!0,enumerable:!0,configurable:!0};else{o=e[u];for(var f in o)-1===["value","get","set","writable","enumerable","configurable"].indexOf(f)?(r.properties[f]=r.properties[f]||{},r.properties[f][u]=o[f],delete o[f]):s=!0;o.hasOwnProperty("writable")||o.hasOwnProperty("set")||o.hasOwnProperty("get")||(o.writable=!0),o.hasOwnProperty("enumerable")||(o.enumerable=!0),o.hasOwnProperty("configurable")||(o.configurable=!0)}s&&h.push({property:u,desc:o})}return i=(t||[]).reduce(function(t,e){return n.merge(t,e.$meta)},{}),r=n.merge(r,i),c.$meta=n.merge(r,this.$meta),h.forEach(function(t){var e=t.property,r=t.desc;c.$meta&&c.$meta.hooks&&c.$meta.hooks.forEach(function(t){t.def&&t.def(e,r,c)}),Object.defineProperty(c,e,r)}),a.forEach(function(t){t(c)}),(c.$meta.hooks||[]).forEach(function(t){t.proto&&t.proto(c)}),c},r.Protoplast=i,e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./utils":9}],9:[function(t,e,r){var n=t("./utils/common"),i=t("./utils/binding"),o=t("./utils/component");e.exports={createObject:n.createObject,merge:n.merge,mixin:n.mixin,uniqueId:n.uniqueId,resolve_property:i.resolve_property,bind:i.bind,bind_property:i.bind_property,bind_collection:i.bind_collection,render_list:o.render_list,create_renderer_function:o.create_renderer_function,dom_processors:{inject_element:o.dom_processors.inject_element,create_component:o.dom_processors.create_component}}},{"./utils/binding":10,"./utils/common":11,"./utils/component":12}],10:[function(t,e,r){var n=function(t,e,r){var i=e.split(".");if(e)if(1===i.length)r(t[e]);else{var o=t[i[0]],s=i.slice(1).join(".");o&&n(o,s,r)}else r(t)},i=function(t,e,r){var o=e.split(".");if(1===o.length)t.on(e+"_changed",r),r(t[e]);else{var s=t[o[0]],c=o.slice(1).join(".");s&&i(s,c,function(){n(s,c,r)}),t.on(o[0]+"_changed",function(e,n){n&&n.on&&n.off(o[0]+"_changed",r),i(t[o[0]],c,r)})}},o=function(t,e,r,o){var s=o.split("."),c=s.pop();i(t,e,function(){n(t,e,function(t){n(r,s.join("."),function(e){e&&(e[c]=t)})})})},s=function(t,e,r){var o,s=null;i(t,e,function(){n(t,e,function(e){s&&(s.off("changed",o),s=null,o=null),e&&(s=e,o=r.bind(t,e),e.on("changed",o),r(e))})})};e.exports={resolve_property:n,bind:i,bind_property:o,bind_collection:s}},{}],11:[function(t,e,r){function n(t){var e=++a;return(t||"")+e}function i(t,e){var r=Object.create(t);return r.$meta.constructors&&r.$meta.constructors.forEach(function(t){t.apply(r,e)}),r}function o(t,e){for(var r in e)e.hasOwnProperty(r)&&(e[r]instanceof Array?t[r]=e[r].concat(t[r]||[]):-1!==["number","boolean","string","function"].indexOf(typeof e[r])?t.hasOwnProperty(r)||(t[r]=e[r]):(t[r]=t[r]||{},o(t[r],e[r])));return t}function s(t,e){for(var r in e)"__"!==r.substr(0,2)&&(t[r]=e[r]);return t}function c(t,e){return e.forEach(function(e){s(t,e)}),t}var a=0;e.exports={createObject:i,merge:o,mixin:c,uniqueId:n}},{}],12:[function(t,e,r){var n=t("./binding"),i={attribute:"data-prop",process:function(t,e,r){!function(e){t[r]=e,t.$meta.element_wrapper&&(t[r]=t.$meta.element_wrapper(t[r]))}(e)}},o={attribute:"data-comp",process:function(t,e,r){var n=t[r]=t.$meta.properties.component[r].create();t.attach(n,e)}},s={remove:function(t,e){t.remove(e)},create:function(t,e,r,n){var i=r.create();i[n]=e,t.add(i)},update:function(t,e,r){t[r]=e}},c=function(t,e){if(e=e||{},e.create=e.create||s.create,e.remove=e.remove||s.remove,e.update=e.update||s.update,e.renderer_data_property=e.renderer_data_property||"data",!e.renderer)throw new Error("Renderer is required");return function(t){for(var r=Math.max(this.children.length,t.length),n=this.children.concat(),i=0;r>i;i++)n[i]&&t.toArray()[i]?e.update(n[i],t.toArray()[i],e.renderer_data_property):n[i]?t.toArray()[i]||e.remove(this,n[i]):e.create(this,t.toArray()[i],e.renderer,e.renderer_data_property)}.bind(t)},a=function(t,e,r){var i=c(t,r);n.bind_collection(t,e,i)};e.exports={create_renderer_function:c,render_list:a,dom_processors:{inject_element:i,create_component:o}}},{"./binding":10}],13:[function(t,e,r){(function(r){var n=t("./js/protoplast"),i=t("./js/collection"),o=t("./js/collection-view"),s=t("./js/dispatcher"),c=t("./js/di"),a=t("./js/component"),h=t("./js/model"),u=t("./js/utils"),f=t("./js/constructors"),d={extend:n.extend.bind(n),create:n.create.bind(n),Dispatcher:s,Context:c,Component:a,Model:h,Collection:i,CollectionView:o,constructors:f,utils:u};r.Protoplast=d,e.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./js/collection":2,"./js/collection-view":1,"./js/component":3,"./js/constructors":4,"./js/di":5,"./js/dispatcher":6,"./js/model":7,"./js/protoplast":8,"./js/utils":9}]},{},[13])(13)});