!function(t){"use strict";function n(t,n){return t.map(function(t){return t[n]}).filter(Boolean)}function i(t){var i={};return t=t||{},t.plugins=t.plugins||[],i.__config=t,i.init=function(){},i.extend=function(t){var o,s,r=Object.create(this),c=this,e={};t=t||function(){},s=t(r,this,e),o=function(){return u.instance=Object.create(r),u.args=Array.prototype.slice.call(arguments),p.pre_init.forEach(function(t){t.call(u)}),u.instance.init.apply(u.instance,u.args),p.post_init.forEach(function(t){t.call(u)}),u.instance},e.plugins=(this.__config.plugins||[]).concat(e.plugins||[]);var u={proto:r,factory:t,base:c,config:e,base_config:this.__config,factory_result:s,Proto:i,constructor:o},p={merge_config:n(e.plugins,"merge_config_processor"),pre_init:n(e.plugins,"pre_init_processor"),post_init:n(e.plugins,"post_init_processor"),constructor:n(e.plugins,"constructor_processor"),proto:n(e.plugins,"proto_processor"),protoplast:n(e.plugins,"protoplast_processor")};return p.merge_config.forEach(function(t){t.call(u)}),r.__config=e,p.proto.forEach(function(t){t.call(u)}),o.extend=i.extend.bind(r),o.__proto=r,p.constructor.forEach(function(t){t.call(u)}),o},n(t.plugins,"protoplast_processor").forEach(function(t){t.call(null,i)}),i}t.Protoplast={create:i,plugins:{},get_all_plugins:function(){var t=[];for(var n in this.plugins)t.push(this.plugins[n]);return t}}}(this),function(t){"use strict";function n(t,n,i,o){o=o||t[n],t[n]=function(){i.before&&i.before.apply(this,arguments);var t=o.apply(this,arguments);return i.after&&(t=i.after.apply(this,arguments)),t}}var i=t.Protoplast;i.plugins.aop={wrap:n,constructor_processor:function(){var t=this.proto,i=this.base;this.constructor.aop=function(o,s){o instanceof Array||(o=[o]),o.forEach(function(o){if(t[o]instanceof Function){t.hasOwnProperty(o)||(t[o]=function(){i[o].apply(this,arguments)});var r=t[o];n(t,o,s,r)}})}}}}(this),function(t){"use strict";function n(t){return function(){return r[t]instanceof Function?r[t].apply(this,arguments):r[t]}}function i(t,n){for(var i in n)t[i]=n[i];return t}function o(t,i){for(var o in i)t[o]=n(i[o]).bind(t)}var s=t.Protoplast,r={};s.plugins.di={merge_config_processor:function(){this.config.inject=i(this.config.inject||{},this.base_config.inject||{})},pre_init_processor:function(){o(this.instance,this.config.inject)},protoplast_processor:function(t){t.register=function(t,n){r[t]=n}}}}(this),function(t){"use strict";var n=t.Protoplast;n.plugins.dispatcher={protoplast_processor:function(t){t.Dispatcher=t.extend(function(t){t.dispatch=function(t,n){this._topics=this._topics||{},(this._topics[t]||[]).forEach(function(t){t.handler.call(t.context,n)})},t.on=function(t,n,i){this._topics=this._topics||{},this._topics[t]=this._topics[t]||[],this._topics[t].push({handler:n,context:i})},t.off=function(t,n,i){this._topics=this._topics||{},this._topics[t]=this._topics[t].filter(function(t){return n?t.handler!==n:t.context!==i})}})}}}(this),function(t){"use strict";function n(t,n){for(var i in n)"init"!==i&&(t[i]=n[i]);return t}function i(t,i){return i.forEach(function(i){n(t,i())}),t}var o=t.Protoplast;o.plugins.mixin={merge_config_processor:function(){this.config.mixin=(this.config.mixin||[]).concat(this.base_config.mixin||[])},pre_init_processor:function(){i(this.instance,this.config.mixin)}}}(this),function(t){"use strict";var n=t.Protoplast;n.plugins.pubsub={protoplast_processor:function(t){t.register("pub",function(n,i){t.dispatcher.dispatch(n,i)}),t.register("sub",function(n){var i=this;return{add:function(o){t.dispatcher.on(n,o,i)},remove:function(o){t.dispatcher.off(n,o,i)}}}),t.dispatcher=t.Dispatcher()}}}(this);